<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amir'O Graphy - Photography Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --primary-light: #5dade2;
            --secondary: #2c3e50;
            --accent: #e74c3c;
            --accent-light: #ec7063;
            --success: #2ecc71;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --darker: #1a252f;
            --gray: #95a5a6;
            --white: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Animated Background Glow */
        .glow-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, 
                rgba(52, 152, 219, 0.1) 0%, 
                rgba(231, 76, 60, 0.05) 50%, 
                rgba(46, 204, 113, 0.05) 100%);
            z-index: -1;
            opacity: 0;
            animation: pulseGlow 8s infinite alternate;
        }
        
        @keyframes pulseGlow {
            0% {
                opacity: 0.3;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.02);
            }
            100% {
                opacity: 0.3;
                transform: scale(1);
            }
        }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--darker);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            border-bottom-color: var(--accent);
            animation: spin 1.5s linear infinite;
            margin-bottom: 20px;
            position: relative;
        }
        
        .loading-spinner::after {
            content: '';
            position: absolute;
            top: -8px;
            left: -8px;
            right: -8px;
            bottom: -8px;
            border: 5px solid rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            border-top-color: var(--success);
            border-bottom-color: var(--warning);
            animation: spinReverse 2s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes spinReverse {
            to { transform: rotate(-360deg); }
        }
        
        .loading-text {
            color: white;
            font-size: 1.2rem;
            margin-top: 20px;
            text-align: center;
            position: relative;
        }
        
        .loading-text::after {
            content: '...';
            position: absolute;
            animation: dots 1.5s infinite steps(3);
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        /* Header */
        header {
            background-color: var(--secondary);
            color: white;
            text-align: center;
            padding: 2rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .hero-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.3;
            z-index: 0;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        
        /* Photo Carousel */
        .photo-carousel {
            width: 100%;
            height: 200px;
            overflow: hidden;
            position: relative;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .carousel-track {
            display: flex;
            width: 500%;
            height: 100%;
            animation: carouselScroll 30s linear infinite;
        }
        
        .carousel-slide {
            width: 20%;
            height: 100%;
            flex-shrink: 0;
        }
        
        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        @keyframes carouselScroll {
            0% { transform: translateX(0); }
            20% { transform: translateX(0); }
            25% { transform: translateX(-20%); }
            45% { transform: translateX(-20%); }
            50% { transform: translateX(-40%); }
            70% { transform: translateX(-40%); }
            75% { transform: translateX(-60%); }
            95% { transform: translateX(-60%); }
            100% { transform: translateX(-80%); }
        }
        
        /* Navigation */
        nav {
            background-color: var(--white);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-container {
            display: flex;
            justify-content: space-around;
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-item:hover {
            background-color: var(--light);
            transform: translateY(-2px);
        }
        
        .nav-item.active {
            color: var(--primary);
        }
        
        .nav-item i {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }
        
        .nav-item .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--accent);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Container */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--secondary);
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 3px;
        }
        
        /* Marketplace */
        .marketplace {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .photo-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .photo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .photo-thumbnail {
            width: 100%;
            height: 220px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .photo-card:hover .photo-thumbnail {
            transform: scale(1.05);
        }
        
        .photo-details {
            padding: 1.2rem;
        }
        
        .photo-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .photo-author {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .pro-badge {
            background-color: var(--primary);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            gap: 3px;
        }
        
        .photo-price {
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .free-badge {
            background-color: var(--success);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            font-weight: bold;
        }
        
        .photo-stats {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .photo-stat {
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        .action-btn {
            display: block;
            width: 100%;
            padding: 0.7rem;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .download-btn {
            background-color: var(--primary);
            color: white;
        }
        
        .download-btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .buy-btn {
            background-color: var(--accent);
            color: white;
        }
        
        .buy-btn:hover {
            background-color: var(--accent-light);
            transform: translateY(-2px);
        }
        
        /* Upload Area */
        .upload-area {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 2px dashed var(--light);
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }
        
        .upload-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
            margin: 0 auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        /* Feed */
        .feed {
            display: grid;
            gap: 2rem;
        }
        
        .feed-post {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .feed-post:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .post-image {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
        }
        
        .post-header {
            display: flex;
            align-items: center;
            padding: 1rem;
            gap: 10px;
        }
        
        .post-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .post-user-name {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .post-caption {
            padding: 0 1rem 1rem;
        }
        
        .post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 0.5rem;
        }
        
        .post-tag {
            background-color: var(--light);
            color: var(--secondary);
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .post-actions {
            display: flex;
            padding: 0.8rem 1rem;
            border-top: 1px solid #eee;
        }
        
        .post-action {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-right: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .post-action:hover {
            color: var(--primary);
            transform: scale(1.1);
        }
        
        .post-action.liked {
            color: var(--accent);
        }
        
        /* Profile */
        .profile-header {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            z-index: 0;
        }
        
        .profile-pic {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid var(--white);
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .profile-name {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .profile-bio {
            color: #666;
            margin-bottom: 1rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            z-index: 1;
        }
        
        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }
        
        .stat-item {
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 5px;
        }
        
        .stat-item:hover {
            background-color: rgba(236, 240, 241, 0.5);
            transform: translateY(-3px);
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.3rem;
            color: var(--secondary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .member-badge {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
            box-shadow: 0 3px 10px rgba(52, 152, 219, 0.3);
        }
        
        .profile-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 1.5rem;
            background-color: white;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .profile-tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
        }
        
        .profile-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            background-color: rgba(52, 152, 219, 0.05);
        }
        
        .profile-tab:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .profile-tab .badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--accent);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* About Section */
        .about-section {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .about-content {
            line-height: 1.6;
        }
        
        .about-content p {
            margin-bottom: 1rem;
        }
        
        .about-content h3 {
            margin: 1.5rem 0 1rem;
            color: var(--secondary);
            position: relative;
            padding-bottom: 5px;
        }
        
        .about-content h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 2px;
            background-color: var(--primary);
        }
        
        .about-content ul {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .about-content li {
            margin-bottom: 0.5rem;
            position: relative;
        }
        
        .about-content li::before {
            content: '•';
            color: var(--primary);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }
        
        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(-30px);
            transition: all 0.3s ease;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            color: var(--accent);
            transform: rotate(90deg);
        }
        
        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: var(--secondary);
        }
        
        .google-login-btn {
            background-color: #4285F4;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin: 0 auto;
            width: 100%;
            justify-content: center;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(66, 133, 244, 0.3);
        }
        
        .google-login-btn:hover {
            background-color: #357ABD;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.4);
        }
        
        .google-icon {
            width: 20px;
            height: 20px;
        }
        
        .modal-text {
            text-align: center;
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }
        
        /* Subscription Options */
        .subscription-options {
            display: grid;
            gap: 1.2rem;
            margin-top: 1.5rem;
        }
        
        .subscription-card {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .subscription-card:hover {
            border-color: var(--primary);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transform: translateY(-5px);
        }
        
        .subscription-card.selected {
            border-color: var(--primary);
            background-color: rgba(52, 152, 219, 0.05);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }
        
        .subscription-card.popular::after {
            content: 'Most Popular';
            position: absolute;
            top: 10px;
            right: -30px;
            background-color: var(--accent);
            color: white;
            padding: 0.2rem 2rem;
            font-size: 0.8rem;
            transform: rotate(45deg);
            width: 120px;
            text-align: center;
        }
        
        .subscription-title {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .subscription-price {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--secondary);
        }
        
        .subscription-price span {
            font-size: 1rem;
            color: var(--gray);
            font-weight: normal;
        }
        
        .subscription-features {
            list-style-type: none;
            margin-bottom: 1.5rem;
        }
        
        .subscription-features li {
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            position: relative;
            padding-left: 0;
        }
        
        .subscription-features li::before {
            content: "✓";
            color: var(--success);
            font-weight: bold;
        }
        
        .subscribe-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            padding: 0.8rem;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(52, 152, 219, 0.3);
        }
        
        .subscribe-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        /* Upload Modal */
        .upload-modal-content {
            max-width: 500px;
        }
        
        .upload-preview {
            width: 100%;
            max-height: 300px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            display: none;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--secondary);
        }
        
        .form-input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .tag-item {
            background-color: var(--light);
            color: var(--secondary);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tag-remove {
            cursor: pointer;
            font-size: 0.7rem;
        }
        
        .tag-input {
            flex: 1;
            min-width: 100px;
        }
        
        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .modal-btn {
            flex: 1;
            padding: 0.8rem;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-btn.primary {
            background-color: var(--primary);
            color: white;
            border: none;
        }
        
        .modal-btn.primary:hover {
            background-color: var(--primary-light);
        }
        
        .modal-btn.secondary {
            background-color: white;
            color: var(--secondary);
            border: 1px solid #ddd;
        }
        
        .modal-btn.secondary:hover {
            background-color: var(--light);
        }
        
        /* Admin Panel */
        .admin-controls {
            background-color: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .admin-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .admin-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .admin-btn {
            padding: 0.6rem 1rem;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .admin-btn.notify-all {
            background-color: var(--primary);
            color: white;
        }
        
        .admin-btn.notify-all:hover {
            background-color: var(--primary-light);
        }
        
        .admin-btn.manage-users {
            background-color: var(--success);
            color: white;
        }
        
        .admin-btn.manage-users:hover {
            background-color: #27ae60;
        }
        
        .admin-btn.moderate {
            background-color: var(--warning);
            color: white;
        }
        
        .admin-btn.moderate:hover {
            background-color: #e67e22;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 1001;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            max-width: 350px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-icon {
            font-size: 1.5rem;
            color: var(--success);
        }
        
        .notification-error .notification-icon {
            color: var(--accent);
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }
        
        .notification-close {
            cursor: pointer;
            color: var(--gray);
        }
        
        /* Footer */
        footer {
            background-color: var(--secondary);
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        .footer-text {
            opacity: 0.7;
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .nav-container {
                flex-wrap: wrap;
            }
            
            .nav-item {
                padding: 0.5rem;
                font-size: 0.8rem;
                flex: 1 0 20%;
            }
            
            .nav-item i {
                font-size: 1.2rem;
            }
            
            .marketplace {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .profile-stats {
                gap: 1rem;
            }
            
            .profile-tabs {
                overflow-x: auto;
                white-space: nowrap;
                display: block;
            }
            
            .profile-tab {
                display: inline-block;
            }
            
            .admin-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Background Glow Effect -->
    <div class="glow-effect"></div>
    
    <!-- Loading Screen -->
    <div class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading your visual journey</div>
    </div>
    
    <!-- Header -->
    <header>
        <img src="https://source.unsplash.com/random/1600x900/?photography" alt="Hero Image" class="hero-image">
        <div class="header-content">
            <h1>Amir'O Graphy</h1>
            <p class="tagline">Capturing moments, creating memories</p>
        </div>
    </header>
    
    <!-- Photo Carousel -->
    <div class="container">
        <div class="photo-carousel">
            <div class="carousel-track">
                <div class="carousel-slide">
                    <img src="https://source.unsplash.com/random/800x400/?nature" alt="Nature">
                </div>
                <div class="carousel-slide">
                    <img src="https://source.unsplash.com/random/800x400/?portrait" alt="Portrait">
                </div>
                <div class="carousel-slide">
                    <img src="https://source.unsplash.com/random/800x400/?city" alt="City">
                </div>
                <div class="carousel-slide">
                    <img src="https://source.unsplash.com/random/800x400/?wildlife" alt="Wildlife">
                </div>
                <div class="carousel-slide">
                    <img src="https://source.unsplash.com/random/800x400/?travel" alt="Travel">
                </div>
            </div>
        </div>
    </div>
    
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <div class="nav-item active" onclick="showSection('home')">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </div>
            <div class="nav-item" onclick="showSection('marketplace')">
                <i class="fas fa-store"></i>
                <span>Marketplace</span>
            </div>
            <div class="nav-item" onclick="showSection('feed')">
                <i class="fas fa-images"></i>
                <span>Daily Feed</span>
                <div class="badge">3</div>
            </div>
            <div class="nav-item" onclick="showSection('profile')">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
            <div class="nav-item" onclick="showSection('about')">
                <i class="fas fa-info-circle"></i>
                <span>About Us</span>
            </div>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="container">
        <!-- Home Section -->
        <section id="home-section">
            <h2 class="section-title">Welcome to Amir'O Graphy</h2>
            <p>Discover stunning photography and share your own visual stories with our community.</p>
            
            <div class="marketplace" id="featured-photos" style="margin-top: 2rem;">
                <!-- Featured photos will be loaded here -->
            </div>
            
            <button class="upload-btn" onclick="showSection('feed')">
                <i class="fas fa-upload"></i> Upload Your Photo
            </button>
        </section>
        
        <!-- Marketplace Section -->
        <section id="marketplace-section" style="display: none;">
            <h2 class="section-title">Marketplace</h2>
            <p>Browse and purchase premium photos or download free selections.</p>
            
            <div class="filter-options" style="margin: 1.5rem 0; display: flex; gap: 0.8rem;">
                <button class="action-btn" style="background-color: var(--secondary);" onclick="filterPhotos('all')">All</button>
                <button class="action-btn" style="background-color: var(--success);" onclick="filterPhotos('free')">Free</button>
                <button class="action-btn" style="background-color: var(--primary);" onclick="filterPhotos('premium')">Premium</button>
            </div>
            
            <div class="marketplace" id="marketplace-photos">
                <!-- Photos loaded via JavaScript -->
            </div>
        </section>
        
        <!-- Daily Feed Section -->
        <section id="feed-section" style="display: none;">
            <div class="upload-area">
                <input type="file" id="photo-upload" accept="image/*" style="display: none;">
                <button class="upload-btn" onclick="document.getElementById('photo-upload').click()">
                    <i class="fas fa-plus"></i> Upload Photo
                </button>
            </div>
            
            <h2 class="section-title">Community Feed</h2>
            
            <div class="feed" id="community-feed">
                <!-- Posts loaded via JavaScript -->
            </div>
        </section>
        
        <!-- Profile Section -->
        <section id="profile-section" style="display: none;">
            <div class="profile-header" id="user-profile">
                <!-- Loaded via JavaScript -->
            </div>
            
            <div class="profile-tabs">
                <div class="profile-tab active" onclick="switchTab('uploads')">My Uploads</div>
                <div class="profile-tab" onclick="switchTab('favorites')">Favorites</div>
                <div class="profile-tab" onclick="switchTab('purchased')">Purchased</div>
                <div class="profile-tab" onclick="switchTab('monetization')">Monetization</div>
            </div>
            
            <div id="uploads-tab">
                <div class="marketplace" id="user-uploads">
                    <!-- User's photos loaded via JavaScript -->
                </div>
            </div>
            
            <div id="favorites-tab" style="display: none;">
                <p>Your favorite photos will appear here.</p>
            </div>
            
            <div id="purchased-tab" style="display: none;">
                <p>Photos you've purchased will appear here.</p>
            </div>
            
            <div id="monetization-tab" style="display: none;">
                <div class="about-section">
                    <h3>Monetization Status</h3>
                    <div id="monetization-status">
                        <!-- Loaded via JavaScript -->
                    </div>
                    
                    <div id="apply-monetization" style="margin-top: 1.5rem; display: none;">
                        <button class="action-btn" style="background-color: var(--success);" onclick="applyForMonetization()">
                            <i class="fas fa-dollar-sign"></i> Apply for Monetization
                        </button>
                    </div>
                    
                    <div id="sell-photos" style="margin-top: 1.5rem; display: none;">
                        <h3>Sell Your Photos</h3>
                        <p>Set a price for your approved photos to start earning.</p>
                        <div id="approved-photos" class="marketplace">
                            <!-- Approved photos for sale will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- About Us Section -->
        <section id="about-section" style="display: none;">
            <div class="about-section">
                <h2 class="section-title">About Amir'O Graphy</h2>
                <div class="about-content">
                    <p>Welcome to Amir'O Graphy, a platform dedicated to photographers and visual storytellers. Our mission is to create a community where artists can share their work, gain exposure, and monetize their creativity.</p>
                    
                    <h3>Subscription Plans</h3>
                    <p>We offer different subscription levels to cater to your needs:</p>
                    <ul>
                        <li><strong>Free Plan:</strong> Upload 2 photos per day, download 1 photo per day</li>
                        <li><strong>Explorer ($2.99/month):</strong> Upload 5 photos per day, download 5 photos per day</li>
                        <li><strong>Unlimited ($7.99/month):</strong> Unlimited uploads and downloads, PRO badge, early monetization</li>
                    </ul>
                    
                    <h3>Monetization Guidelines</h3>
                    <p>Earn money from your photos by meeting these requirements:</p>
                    <ul>
                        <li><strong>Free Users:</strong> 100 loves and 20 comments on your photos</li>
                        <li><strong>PRO Users:</strong> 50 loves and 10 comments on your photos</li>
                    </ul>
                    <p>Once approved, you can set prices for your photos and earn 70% of each sale.</p>
                    
                    <h3>Community Guidelines</h3>
                    <p>We encourage respectful engagement within our community. Please:</p>
                    <ul>
                        <li>Credit original photographers when sharing their work</li>
                        <li>Respect copyright and licensing terms</li>
                        <li>Provide constructive feedback</li>
                        <li>Report any inappropriate content</li>
                    </ul>
                    
                    <p>For licensing inquiries or copyright issues, please contact us at <strong>copyright@amirography.com</strong>.</p>
                </div>
            </div>
        </section>
        
        <!-- Admin Section (only visible to admin) -->
        <section id="admin-section" style="display: none;">
            <div class="admin-controls">
                <h3 class="admin-title"><i class="fas fa-shield-alt"></i> Admin Panel</h3>
                
                <div class="admin-actions">
                    <button class="admin-btn notify-all" onclick="notifyAllUsers()">
                        <i class="fas fa-bell"></i> Notify All Users
                    </button>
                    <button class="admin-btn manage-users" onclick="manageUsers()">
                        <i class="fas fa-users-cog"></i> Manage Users
                    </button>
                    <button class="admin-btn moderate" onclick="moderateContent()">
                        <i class="fas fa-flag"></i> Moderate Content
                    </button>
                </div>
                
                <div id="admin-notification-form" style="display: none; margin-top: 1.5rem;">
                    <div class="form-group">
                        <label class="form-label">Notification Message</label>
                        <textarea class="form-input" id="notification-message" rows="3"></textarea>
                    </div>
                    <button class="action-btn" style="background-color: var(--primary);" onclick="sendNotification()">
                        <i class="fas fa-paper-plane"></i> Send Notification
                    </button>
                </div>
                
                <div id="admin-user-list" style="display: none; margin-top: 1.5rem;">
                    <!-- User list will be loaded here -->
                </div>
                
                <div id="admin-content-moderation" style="display: none; margin-top: 1.5rem;">
                    <!-- Content for moderation will be loaded here -->
                </div>
            </div>
        </section>
    </div>
    
    <!-- Login Modal -->
    <div class="modal" id="login-modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h3 class="modal-title">Sign In to Continue</h3>
            <button class="google-login-btn" id="google-login">
                <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google" class="google-icon">
                Sign in with Google
            </button>
            <p class="modal-text">No passwords needed—just your Google account.</p>
        </div>
    </div>
    
    <!-- Subscription Modal -->
    <div class="modal" id="subscription-modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h3 class="modal-title">Upgrade Your Membership</h3>
            <p class="modal-text" style="margin-bottom: 1.5rem;">Choose the plan that works best for you:</p>
            
            <div class="subscription-options">
                <div class="subscription-card" onclick="selectPlan('explorer')" id="explorer-plan">
                    <h4 class="subscription-title">Explorer</h4>
                    <div class="subscription-price">$2.99<span>/month</span></div>
                    <ul class="subscription-features">
                        <li>5 daily uploads</li>
                        <li>5 daily downloads</li>
                        <li>Access to free content</li>
                        <li>Basic support</li>
                    </ul>
                    <button class="subscribe-btn" onclick="subscribe('explorer')">Select Plan</button>
                </div>
                
                <div class="subscription-card selected popular" onclick="selectPlan('unlimited')" id="unlimited-plan">
                    <h4 class="subscription-title">Unlimited</h4>
                    <div class="subscription-price">$7.99<span>/month</span></div>
                    <ul class="subscription-features">
                        <li>Unlimited uploads</li>
                        <li>Unlimited downloads</li>
                        <li>Access to premium content</li>
                        <li>PRO badge</li>
                        <li>Early monetization</li>
                        <li>Priority support</li>
                    </ul>
                    <button class="subscribe-btn" onclick="subscribe('unlimited')">Select Plan</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Upload Modal -->
    <div class="modal" id="upload-modal">
        <div class="modal-content upload-modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h3 class="modal-title">Upload Photo</h3>
            
            <img id="upload-preview" class="upload-preview" alt="Preview">
            
            <div class="form-group">
                <label class="form-label">Photo Title</label>
                <input type="text" class="form-input" id="photo-title" placeholder="Give your photo a title">
            </div>
            
            <div class="form-group">
                <label class="form-label">Tags (Add up to 5 tags)</label>
                <div class="tag-input-container" id="tags-container">
                    <!-- Tags will be added here -->
                </div>
                <input type="text" class="form-input tag-input" id="tag-input" placeholder="Add tags (press enter to add)">
            </div>
            
            <div class="form-group">
                <label class="form-label">Price (Leave 0 for free)</label>
                <input type="number" class="form-input" id="photo-price" min="0" step="0.01" placeholder="0.00">
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                <button class="modal-btn primary" onclick="uploadPhoto()">Upload</button>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="notification-content">
            <div class="notification-title">Success</div>
            <div class="notification-message">Your action was completed successfully</div>
        </div>
        <div class="notification-close" onclick="hideNotification()">
            <i class="fas fa-times"></i>
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <p class="footer-text">© <span id="current-year"></span> Amir'O Graphy. All rights reserved.</p>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { 
            getAuth, 
            GoogleAuthProvider, 
            signInWithPopup,
            onAuthStateChanged
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { 
            getFirestore,
            collection,
            doc,
            setDoc,
            getDoc,
            getDocs,
            addDoc,
            updateDoc,
            deleteDoc,
            serverTimestamp,
            query,
            where,
            orderBy,
            arrayUnion,
            arrayRemove,
            increment,
            limit
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { 
            getStorage,
            ref,
            uploadBytes,
            getDownloadURL,
            deleteObject
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";
        import { 
            getFunctions, 
            httpsCallable 
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBN54CFkJqgO_LMu5BUNRkHnxcC56WdD0w",
            authDomain: "amir-o-graphy.firebaseapp.com",
            projectId: "amir-o-graphy",
            storageBucket: "amir-o-graphy.appspot.com",
            messagingSenderId: "632309878901",
            appId: "1:632309878901:web:2454b17fc530624346683c",
            measurementId: "G-YX7ZQ4ZQF2"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const functions = getFunctions(app);
        const provider = new GoogleAuthProvider();

        // DOM Elements
        const googleLoginBtn = document.getElementById('google-login');
        const photoUploadInput = document.getElementById('photo-upload');
        const currentYearSpan = document.getElementById('current-year');
        const notification = document.getElementById('notification');

        // Set current year in footer
        currentYearSpan.textContent = new Date().getFullYear();

        // Global Variables
        let currentUser = null;
        let currentUserData = null;
        let photos = [];
        let posts = [];
        let tags = [];
        let selectedFile = null;

        // ========================================
        // NOTIFICATION FUNCTIONS
        // ========================================

        function showNotification(title, message, isError = false) {
            const notification = document.getElementById('notification');
            notification.querySelector('.notification-title').textContent = title;
            notification.querySelector('.notification-message').textContent = message;
            
            if (isError) {
                notification.classList.add('notification-error');
            } else {
                notification.classList.remove('notification-error');
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                hideNotification();
            }, 5000);
        }

        function hideNotification() {
            document.getElementById('notification').classList.remove('show');
        }

        // ========================================
        // PHOTO UPLOAD FUNCTIONS
        // ========================================

        photoUploadInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!auth.currentUser) {
                showLoginModal();
                return;
            }
            
            // Check user's upload limit
            if (currentUserData.subscription === 'free' && currentUserData.uploadsToday >= 2) {
                showNotification('Upload Limit', 'Free users can upload up to 2 photos per day. Upgrade to upload more.', true);
                return;
            }
            
            if (currentUserData.subscription === 'explorer' && currentUserData.uploadsToday >= 5) {
                showNotification('Upload Limit', 'Explorer users can upload up to 5 photos per day. Upgrade to unlimited for more.', true);
                return;
            }
            
            selectedFile = file;
            
            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('upload-preview').src = e.target.result;
                document.getElementById('upload-preview').style.display = 'block';
                document.getElementById('photo-title').value = file.name.split('.')[0];
            };
            reader.readAsDataURL(file);
            
            // Reset tags
            tags = [];
            renderTags();
            
            // Show upload modal
            document.getElementById('upload-modal').classList.add('active');
        });

        document.getElementById('tag-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                addTag();
            }
        });

        function addTag() {
            const tagInput = document.getElementById('tag-input');
            const tag = tagInput.value.trim();
            
            if (tag && tags.length < 5) {
                if (!tags.includes(tag)) {
                    tags.push(tag);
                    renderTags();
                }
                tagInput.value = '';
            }
        }

        function removeTag(index) {
            tags.splice(index, 1);
            renderTags();
        }

        function renderTags() {
            const container = document.getElementById('tags-container');
            container.innerHTML = '';
            
            tags.forEach((tag, index) => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag-item';
                tagElement.innerHTML = `
                    ${tag}
                    <span class="tag-remove" onclick="removeTag(${index})">&times;</span>
                `;
                container.appendChild(tagElement);
            });
        }

        async function uploadPhoto() {
            if (!selectedFile || !auth.currentUser) return;
            
            const title = document.getElementById('photo-title').value.trim() || selectedFile.name.split('.')[0];
            const price = parseFloat(document.getElementById('photo-price').value) || 0;
            
            if (tags.length === 0) {
                showNotification('Add Tags', 'Please add at least one tag for your photo', true);
                return;
            }
            
            try {
                // Show loading
                document.querySelector('.loading-screen').classList.remove('hidden');
                
                // Upload to storage
                const storageRef = ref(storage, `photos/${auth.currentUser.uid}/${Date.now()}_${selectedFile.name}`);
                await uploadBytes(storageRef, selectedFile);
                const downloadURL = await getDownloadURL(storageRef);
                
                // Save to Firestore
                await addDoc(collection(db, "photos"), {
                    url: downloadURL,
                    title,
                    tags,
                    price,
                    ownerId: auth.currentUser.uid,
                    ownerName: auth.currentUser.displayName,
                    ownerPhoto: auth.currentUser.photoURL,
                    createdAt: serverTimestamp(),
                    downloads: 0,
                    loves: 0,
                    comments: 0,
                    isPublic: true,
                    isApproved: false,
                    status: 'pending'
                });
                
                // Update user's upload count
                await updateDoc(doc(db, "users", auth.currentUser.uid), {
                    uploadsToday: increment(1),
                    totalUploads: increment(1)
                });
                
                showNotification('Success', 'Photo uploaded successfully!');
                closeModal();
                loadUserPhotos(auth.currentUser.uid);
                loadCommunityFeed();
            } catch (error) {
                console.error("Upload error:", error);
                showNotification('Error', 'Failed to upload photo. Please try again.', true);
            } finally {
                document.querySelector('.loading-screen').classList.add('hidden');
                photoUploadInput.value = '';
            }
        }

        // ========================================
        // PHOTO MANAGEMENT FUNCTIONS
        // ========================================

        async function editPhoto(photoId) {
            // In a real app, implement photo editing functionality
            showNotification('Info', 'Photo editing feature coming soon!');
        }

        async function deletePhoto(photoId) {
            if (!confirm('Are you sure you want to delete this photo?')) return;
            
            try {
                // Get photo data
                const photoDoc = await getDoc(doc(db, "photos", photoId));
                if (!photoDoc.exists()) return;
                
                const photo = photoDoc.data();
                
                // Delete from storage
                const storageRef = ref(storage, photo.url);
                await deleteObject(storageRef);
                
                // Delete from Firestore
                await deleteDoc(doc(db, "photos", photoId));
                
                showNotification('Success', 'Photo deleted successfully');
                loadUserPhotos(auth.currentUser.uid);
            } catch (error) {
                console.error("Delete error:", error);
                showNotification('Error', 'Failed to delete photo', true);
            }
        }

        async function toggleLove(photoId) {
            if (!auth.currentUser) {
                showLoginModal();
                return;
            }
            
            try {
                const photoRef = doc(db, "photos", photoId);
                const userRef = doc(db, "users", auth.currentUser.uid);
                
                // Check if user already loved this photo
                const userDoc = await getDoc(userRef);
                const lovedPhotos = userDoc.data().lovedPhotos || [];
                
                if (lovedPhotos.includes(photoId)) {
                    // Remove love
                    await updateDoc(photoRef, {
                        loves: increment(-1)
                    });
                    
                    await updateDoc(userRef, {
                        lovedPhotos: arrayRemove(photoId)
                    });
                    
                    showNotification('Info', 'Removed love from photo');
                } else {
                    // Add love
                    await updateDoc(photoRef, {
                        loves: increment(1)
                    });
                    
                    await updateDoc(userRef, {
                        lovedPhotos: arrayUnion(photoId)
                    });
                    
                    showNotification('Success', 'Loved this photo!');
                    
                    // Check if owner should be notified
                    const photoDoc = await getDoc(photoRef);
                    const photo = photoDoc.data();
                    
                    if (photo.ownerId !== auth.currentUser.uid) {
                        await addDoc(collection(db, "notifications"), {
                            userId: photo.ownerId,
                            type: 'love',
                            photoId,
                            fromUserId: auth.currentUser.uid,
                            fromUserName: auth.currentUser.displayName,
                            read: false,
                            createdAt: serverTimestamp()
                        });
                    }
                }
                
                // Refresh data
                loadCommunityFeed();
                loadMarketplacePhotos();
            } catch (error) {
                console.error("Love error:", error);
                showNotification('Error', 'Failed to update love', true);
            }
        }

        // ========================================
        // MONETIZATION FUNCTIONS
        // ========================================

        async function checkMonetizationStatus() {
            if (!auth.currentUser) return;
            
            try {
                const userDoc = await getDoc(doc(db, "users", auth.currentUser.uid));
                if (!userDoc.exists()) return;
                
                const userData = userDoc.data();
                const monetizationStatus = document.getElementById('monetization-status');
                const applyBtn = document.getElementById('apply-monetization');
                const sellPhotos = document.getElementById('sell-photos');
                
                if (userData.monetizationApproved) {
                    monetizationStatus.innerHTML = `
                        <div style="background-color: #e8f8f5; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--success);">
                            <h4 style="color: var(--success); margin-bottom: 0.5rem;">
                                <i class="fas fa-check-circle"></i> Monetization Approved
                            </h4>
                            <p>You can now set prices for your approved photos and start earning.</p>
                        </div>
                    `;
                    
                    applyBtn.style.display = 'none';
                    sellPhotos.style.display = 'block';
                    
                    // Load approved photos
                    loadApprovedPhotos();
                } else if (userData.monetizationApplied) {
                    monetizationStatus.innerHTML = `
                        <div style="background-color: #fef9e7; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--warning);">
                            <h4 style="color: var(--warning); margin-bottom: 0.5rem;">
                                <i class="fas fa-clock"></i> Application Pending
                            </h4>
                            <p>Your monetization application is under review. We'll notify you once approved.</p>
                        </div>
                    `;
                    
                    applyBtn.style.display = 'none';
                    sellPhotos.style.display = 'none';
                } else {
                    // Check if user meets requirements
                    const q = query(collection(db, "photos"), 
                        where("ownerId", "==", auth.currentUser.uid),
                        where("isPublic", "==", true));
                    
                    const snapshot = await getDocs(q);
                    let totalLoves = 0;
                    let totalComments = 0;
                    
                    snapshot.forEach(doc => {
                        const photo = doc.data();
                        totalLoves += photo.loves || 0;
                        totalComments += photo.comments || 0;
                    });
                    
                    const requiredLoves = userData.subscription === 'unlimited' ? 50 : 100;
                    const requiredComments = userData.subscription === 'unlimited' ? 10 : 20;
                    
                    if (totalLoves >= requiredLoves && totalComments >= requiredComments) {
                        monetizationStatus.innerHTML = `
                            <div style="background-color: #eaf2f8; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
                                <h4 style="color: var(--primary); margin-bottom: 0.5rem;">
                                    <i class="fas fa-gem"></i> Ready for Monetization
                                </h4>
                                <p>You meet the requirements to apply for monetization!</p>
                                <p><strong>Stats:</strong> ${totalLoves} loves, ${totalComments} comments</p>
                            </div>
                        `;
                        
                        applyBtn.style.display = 'block';
                        sellPhotos.style.display = 'none';
                    } else {
                        monetizationStatus.innerHTML = `
                            <div style="background-color: #f5eef8; padding: 1rem; border-radius: 8px; border-left: 4px solid #9b59b6;">
                                <h4 style="color: #9b59b6; margin-bottom: 0.5rem;">
                                    <i class="fas fa-lock"></i> Monetization Locked
                                </h4>
                                <p>You need ${requiredLoves - totalLoves} more loves and ${requiredComments - totalComments} more comments to apply.</p>
                                <p><strong>Current Stats:</strong> ${totalLoves} loves, ${totalComments} comments</p>
                                ${userData.subscription !== 'unlimited' ? 
                                    `<p style="margin-top: 0.5rem;">Upgrade to PRO to qualify with only 50 loves and 10 comments!</p>` : ''}
                            </div>
                        `;
                        
                        applyBtn.style.display = 'none';
                        sellPhotos.style.display = 'none';
                    }
                }
            } catch (error) {
                console.error("Monetization check error:", error);
            }
        }

        async function applyForMonetization() {
            if (!auth.currentUser) return;
            
            try {
                await updateDoc(doc(db, "users", auth.currentUser.uid), {
                    monetizationApplied: true,
                    monetizationAppliedAt: serverTimestamp()
                });
                
                // Notify admin
                await addDoc(collection(db, "adminNotifications"), {
                    type: 'monetizationRequest',
                    userId: auth.currentUser.uid,
                    userName: auth.currentUser.displayName,
                    read: false,
                    createdAt: serverTimestamp()
                });
                
                showNotification('Success', 'Monetization application submitted for review');
                checkMonetizationStatus();
            } catch (error) {
                console.error("Apply error:", error);
                showNotification('Error', 'Failed to apply for monetization', true);
            }
        }

        async function loadApprovedPhotos() {
            try {
                const q = query(collection(db, "photos"), 
                    where("ownerId", "==", auth.currentUser.uid),
                    where("isPublic", "==", true),
                    where("isApproved", "==", true),
                    orderBy("createdAt", "desc"));
                
                const snapshot = await getDocs(q);
                const container = document.getElementById('approved-photos');
                container.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const photo = doc.data();
                    container.innerHTML += `
                        <div class="photo-card">
                            <img src="${photo.url}" alt="${photo.title}" class="photo-thumbnail">
                            <div class="photo-details">
                                <h3 class="photo-title">${photo.title}</h3>
                                <div class="form-group">
                                    <label class="form-label">Set Price ($)</label>
                                    <input type="number" class="form-input" id="price-${doc.id}" 
                                        value="${photo.price || 0}" min="0" step="0.01">
                                </div>
                                <button class="action-btn" style="background-color: var(--success);" 
                                    onclick="updatePhotoPrice('${doc.id}')">
                                    <i class="fas fa-save"></i> Save Price
                                </button>
                            </div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error("Load approved error:", error);
            }
        }

        async function updatePhotoPrice(photoId) {
            const priceInput = document.getElementById(`price-${photoId}`);
            const price = parseFloat(priceInput.value) || 0;
            
            try {
                await updateDoc(doc(db, "photos", photoId), {
                    price: price
                });
                
                showNotification('Success', 'Price updated successfully');
            } catch (error) {
                console.error("Price update error:", error);
                showNotification('Error', 'Failed to update price', true);
            }
        }

        // ========================================
        // ADMIN FUNCTIONS
        // ========================================

        async function notifyAllUsers() {
            document.getElementById('admin-notification-form').style.display = 'block';
            document.getElementById('admin-user-list').style.display = 'none';
            document.getElementById('admin-content-moderation').style.display = 'none';
        }

        async function manageUsers() {
            document.getElementById('admin-notification-form').style.display = 'none';
            document.getElementById('admin-content-moderation').style.display = 'none';
            
            const userList = document.getElementById('admin-user-list');
            userList.style.display = 'block';
            userList.innerHTML = '<p>Loading users...</p>';
            
            try {
                const snapshot = await getDocs(collection(db, "users"));
                userList.innerHTML = '<h4>User Management</h4>';
                
                snapshot.forEach(doc => {
                    const user = doc.data();
                    userList.innerHTML += `
                        <div style="background-color: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${user.name}</strong>
                                    <div style="font-size: 0.8rem; color: var(--gray);">
                                        ${user.email} • ${user.subscription || 'free'}
                                    </div>
                                </div>
                                <div>
                                    <button class="action-btn" style="background-color: var(--primary); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="sendUserNotification('${doc.id}')">
                                        Notify
                                    </button>
                                    <button class="action-btn" style="background-color: var(--warning); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                        onclick="suspendUser('${doc.id}', ${user.suspended || false})">
                                        ${user.suspended ? 'Unsuspend' : 'Suspend'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error("User load error:", error);
                userList.innerHTML = '<p>Error loading users</p>';
            }
        }

        async function moderateContent() {
            document.getElementById('admin-notification-form').style.display = 'none';
            document.getElementById('admin-user-list').style.display = 'none';
            
            const contentMod = document.getElementById('admin-content-moderation');
            contentMod.style.display = 'block';
            contentMod.innerHTML = '<p>Loading content for moderation...</p>';
            
            try {
                // Get pending monetization requests
                const monetizationQuery = query(collection(db, "adminNotifications"), 
                    where("type", "==", "monetizationRequest"),
                    where("read", "==", false),
                    orderBy("createdAt", "desc"));
                
                const monetizationSnapshot = await getDocs(monetizationQuery);
                
                // Get reported content
                const reportedQuery = query(collection(db, "reports"), 
                    where("resolved", "==", false),
                    orderBy("createdAt", "desc"));
                
                const reportedSnapshot = await getDocs(reportedQuery);
                
                contentMod.innerHTML = `
                    <h4>Content Moderation</h4>
                    <div style="margin-bottom: 2rem;">
                        <h5 style="margin-bottom: 0.5rem; color: var(--primary);">
                            <i class="fas fa-gem"></i> Monetization Requests
                        </h5>
                        ${monetizationSnapshot.empty ? 
                            '<p>No pending monetization requests</p>' : 
                            monetizationSnapshot.docs.map(doc => {
                                const req = doc.data();
                                return `
                                    <div style="background-color: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <strong>${req.userName}</strong>
                                            <div style="font-size: 0.8rem; color: var(--gray);">
                                                ${new Date(req.createdAt?.toDate()).toLocaleString()}
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="action-btn" style="background-color: var(--success); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                                onclick="approveMonetization('${req.userId}', '${doc.id}')">
                                                Approve
                                            </button>
                                            <button class="action-btn" style="background-color: var(--accent); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                                onclick="rejectMonetization('${req.userId}', '${doc.id}')">
                                                Reject
                                            </button>
                                            <button class="action-btn" style="background-color: var(--primary); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                                onclick="viewUser('${req.userId}')">
                                                View Profile
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                    </div>
                    <div>
                        <h5 style="margin-bottom: 0.5rem; color: var(--accent);">
                            <i class="fas fa-flag"></i> Reported Content
                        </h5>
                        ${reportedSnapshot.empty ? 
                            '<p>No reported content</p>' : 
                            reportedSnapshot.docs.map(doc => {
                                const report = doc.data();
                                return `
                                    <div style="background-color: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                            <div>
                                                <strong>${report.reason}</strong>
                                                <div style="font-size: 0.8rem; color: var(--gray);">
                                                    Reported by: ${report.reporterName}
                                                </div>
                                            </div>
                                            <div style="font-size: 0.8rem; color: var(--gray);">
                                                ${new Date(report.createdAt?.toDate()).toLocaleString()}
                                            </div>
                                        </div>
                                        <p style="margin-bottom: 0.5rem;">${report.details || 'No details provided'}</p>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="action-btn" style="background-color: var(--accent); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                                onclick="removeContent('${report.contentId}', '${report.contentType}', '${doc.id}')">
                                                Remove Content
                                            </button>
                                            <button class="action-btn" style="background-color: var(--gray); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                                onclick="dismissReport('${doc.id}')">
                                                Dismiss
                                            </button>
                                            <button class="action-btn" style="background-color: var(--warning); padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                                                onclick="suspendUser('${report.userId}', true)">
                                                Suspend User
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                    </div>
                `;
            } catch (error) {
                console.error("Moderation error:", error);
                contentMod.innerHTML = '<p>Error loading content for moderation</p>';
            }
        }

        async function sendNotification() {
            const message = document.getElementById('notification-message').value.trim();
            if (!message) return;
            
            try {
                // Save notification to all users
                const usersSnapshot = await getDocs(collection(db, "users"));
                
                usersSnapshot.forEach(async (userDoc) => {
                    await addDoc(collection(db, "notifications"), {
                        userId: userDoc.id,
                        type: 'admin',
                        message,
                        read: false,
                        createdAt: serverTimestamp()
                    });
                });
                
                showNotification('Success', 'Notification sent to all users');
                document.getElementById('notification-message').value = '';
                document.getElementById('admin-notification-form').style.display = 'none';
            } catch (error) {
                console.error("Notification error:", error);
                showNotification('Error', 'Failed to send notification', true);
            }
        }

        async function sendUserNotification(userId) {
            const message = prompt("Enter notification message:");
            if (!message) return;
            
            try {
                await addDoc(collection(db, "notifications"), {
                    userId,
                    type: 'admin',
                    message,
                    read: false,
                    createdAt: serverTimestamp()
                });
                
                showNotification('Success', 'Notification sent to user');
            } catch (error) {
                console.error("User notification error:", error);
                showNotification('Error', 'Failed to send notification', true);
            }
        }

        async function suspendUser(userId, suspend) {
            try {
                await updateDoc(doc(db, "users", userId), {
                    suspended: suspend
                });
                
                showNotification('Success', `User ${suspend ? 'suspended' : 'unsuspended'}`);
                manageUsers();
            } catch (error) {
                console.error("Suspend error:", error);
                showNotification('Error', 'Failed to update user status', true);
            }
        }

        async function approveMonetization(userId, notificationId) {
            try {
                // Update user status
                await updateDoc(doc(db, "users", userId), {
                    monetizationApproved: true,
                    monetizationApprovedAt: serverTimestamp()
                });
                
                // Mark notification as read
                await updateDoc(doc(db, "adminNotifications", notificationId), {
                    read: true
                });
                
                // Notify user
                await addDoc(collection(db, "notifications"), {
                    userId,
                    type: 'monetizationApproved',
                    read: false,
                    createdAt: serverTimestamp()
                });
                
                showNotification('Success', 'Monetization approved');
                moderateContent();
            } catch (error) {
                console.error("Approve error:", error);
                showNotification('Error', 'Failed to approve monetization', true);
            }
        }

        async function rejectMonetization(userId, notificationId) {
            try {
                // Mark notification as read
                await updateDoc(doc(db, "adminNotifications", notificationId), {
                    read: true
                });
                
                // Notify user
                await addDoc(collection(db, "notifications"), {
                    userId,
                    type: 'monetizationRejected',
                    read: false,
                    createdAt: serverTimestamp()
                });
                
                showNotification('Info', 'Monetization request rejected');
                moderateContent();
            } catch (error) {
                console.error("Reject error:", error);
                showNotification('Error', 'Failed to reject monetization', true);
            }
        }

        async function removeContent(contentId, contentType, reportId) {
            try {
                if (contentType === 'photo') {
                    // Get photo data
                    const photoDoc = await getDoc(doc(db, "photos", contentId));
                    if (photoDoc.exists()) {
                        const photo = photoDoc.data();
                        
                        // Delete from storage
                        const storageRef = ref(storage, photo.url);
                        await deleteObject(storageRef);
                        
                        // Delete from Firestore
                        await deleteDoc(doc(db, "photos", contentId));
                    }
                }
                
                // Mark report as resolved
                await updateDoc(doc(db, "reports", reportId), {
                    resolved: true,
                    resolvedAt: serverTimestamp()
                });
                
                showNotification('Success', 'Content removed and report resolved');
                moderateContent();
            } catch (error) {
                console.error("Remove error:", error);
                showNotification('Error', 'Failed to remove content', true);
            }
        }

        async function dismissReport(reportId) {
            try {
                // Mark report as resolved
                await updateDoc(doc(db, "reports", reportId), {
                    resolved: true,
                    resolvedAt: serverTimestamp()
                });
                
                showNotification('Info', 'Report dismissed');
                moderateContent();
            } catch (error) {
                console.error("Dismiss error:", error);
                showNotification('Error', 'Failed to dismiss report', true);
            }
        }

        async function viewUser(userId) {
            // In a real app, you would navigate to the user's profile
            alert(`Viewing user ${userId}`);
        }

        // ========================================
        // FIREBASE DATA FUNCTIONS
        // ========================================

        async function signInWithGoogle() {
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;
                
                // Check if user exists in Firestore
                const userDoc = await getDoc(doc(db, "users", user.uid));
                
                if (!userDoc.exists()) {
                    // Create new user document
                    await setDoc(doc(db, "users", user.uid), {
                        name: user.displayName,
                        email: user.email,
                        photoURL: user.photoURL,
                        subscription: "free",
                        joinDate: serverTimestamp(),
                        purchasedPhotos: [],
                        lovedPhotos: [],
                        uploadsToday: 0,
                        downloadsToday: 0,
                        totalUploads: 0,
                        totalDownloads: 0,
                        monetizationApplied: false,
                        monetizationApproved: false,
                        suspended: false,
                        isAdmin: user.email === "ahamed.to.tipak@gmail.com" // Set admin
                    });
                }
                
                closeModal();
                updateUserProfile(user);
                
                // Check if user is admin
                const userData = userDoc.data();
                if (userData.isAdmin) {
                    document.getElementById('admin-section').style.display = 'block';
                }
            } catch (error) {
                console.error("Google sign-in error:", error);
                showNotification('Error', 'Sign-in failed. Please try again.', true);
            }
        }

        async function updateUserProfile(user) {
            const userDoc = await getDoc(doc(db, "users", user.uid));
            if (userDoc.exists()) {
                currentUserData = userDoc.data();
                const profileHeader = document.getElementById('user-profile');
                
                profileHeader.innerHTML = `
                    <img src="${user.photoURL || 'https://source.unsplash.com/random/300x300/?portrait'}" 
                         alt="Profile" class="profile-pic">
                    <h2 class="profile-name">${user.displayName || 'User'}
                        ${currentUserData.subscription === 'unlimited' ? 
                            '<span class="pro-badge"><i class="fas fa-crown"></i> PRO</span>' : ''}
                    </h2>
                    <p class="profile-bio">${currentUserData.bio || 'No bio yet'}</p>
                    
                    <div class="member-badge">
                        <i class="fas fa-${currentUserData.subscription === 'unlimited' ? 'crown' : 'user'}"></i> 
                        ${currentUserData.subscription === 'unlimited' ? 'PRO MEMBER' : 
                         currentUserData.subscription === 'explorer' ? 'EXPLORER MEMBER' : 'FREE MEMBER'}
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat-item" onclick="switchTab('uploads')">
                            <div class="stat-value" id="photo-count">0</div>
                            <div class="stat-label">Photos</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${currentUserData.followers?.length || 0}</div>
                            <div class="stat-label">Followers</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${currentUserData.following?.length || 0}</div>
                            <div class="stat-label">Following</div>
                        </div>
                    </div>
                    
                    <button class="action-btn" style="background: ${currentUserData.subscription === 'unlimited' ? 
                        'linear-gradient(135deg, var(--accent), var(--accent-light))' : 
                        'linear-gradient(135deg, var(--primary), var(--primary-light))'};" 
                            onclick="showSubscriptionModal()">
                        ${currentUserData.subscription === 'unlimited' ? 'Manage Plan' : 'Upgrade Plan'}
                    </button>
                `;
                
                // Load user-specific data
                loadUserPhotos(user.uid);
                checkMonetizationStatus();
            }
        }

        async function loadFeaturedPhotos() {
            try {
                const q = query(collection(db, "photos"), 
                              where("isPublic", "==", true),
                              orderBy("createdAt", "desc"),
                              limit(4));
                const snapshot = await getDocs(q);
                
                const featuredContainer = document.getElementById('featured-photos');
                featuredContainer.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const photo = doc.data();
                    featuredContainer.innerHTML += `
                        <div class="photo-card">
                            <img src="${photo.url}" alt="${photo.title}" class="photo-thumbnail">
                            <div class="photo-details">
                                <h3 class="photo-title">${photo.title}</h3>
                                <div class="photo-author">
                                    <span>by ${photo.ownerName}</span>
                                    ${photo.ownerSubscription === 'unlimited' ? 
                                        '<span class="pro-badge" style="font-size: 0.6rem; padding: 0.1rem 0.4rem;">PRO</span>' : ''}
                                </div>
                                <div class="photo-stats">
                                    <div class="photo-stat">
                                        <i class="fas fa-heart"></i> ${photo.loves || 0}
                                    </div>
                                    <div class="photo-stat">
                                        <i class="fas fa-comment"></i> ${photo.comments || 0}
                                    </div>
                                    <div class="photo-stat">
                                        <i class="fas fa-download"></i> ${photo.downloads || 0}
                                    </div>
                                </div>
                                ${photo.price > 0 ? 
                                    `<div class="photo-price">$${photo.price.toFixed(2)}</div>
                                     <button class="action-btn buy-btn" onclick="handlePhotoAction('${doc.id}', ${photo.price})">
                                        <i class="fas fa-shopping-cart"></i> Buy Now
                                     </button>` :
                                    `<span class="free-badge">FREE</span>
                                     <button class="action-btn download-btn" onclick="handlePhotoAction('${doc.id}', 0)">
                                        <i class="fas fa-download"></i> Download
                                     </button>`}
                            </div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error("Error loading featured photos:", error);
            }
        }

        async function loadMarketplacePhotos(filter = 'all') {
            try {
                let q;
                if (filter === 'free') {
                    q = query(collection(db, "photos"), 
                        where("isPublic", "==", true),
                        where("price", "==", 0),
                        orderBy("createdAt", "desc"));
                } else if (filter === 'premium') {
                    q = query(collection(db, "photos"), 
                        where("isPublic", "==", true),
                        where("price", ">", 0),
                        orderBy("price"),
                        orderBy("createdAt", "desc"));
                } else {
                    q = query(collection(db, "photos"), 
                        where("isPublic", "==", true),
                        orderBy("createdAt", "desc"));
                }
                
                const snapshot = await getDocs(q);
                const marketplaceContainer = document.getElementById('marketplace-photos');
                marketplaceContainer.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const photo = doc.data();
                    marketplaceContainer.innerHTML += `
                        <div class="photo-card">
                            <img src="${photo.url}" alt="${photo.title}" class="photo-thumbnail">
                            <div class="photo-details">
                                <h3 class="photo-title">${photo.title}</h3>
                                <div class="photo-author">
                                    <span>by ${photo.ownerName}</span>
                                    ${photo.ownerSubscription === 'unlimited' ? 
                                        '<span class="pro-badge" style="font-size: 0.6rem; padding: 0.1rem 0.4rem;">PRO</span>' : ''}
                                </div>
                                <div class="photo-stats">
                                    <div class="photo-stat">
                                        <i class="fas fa-heart"></i> ${photo.loves || 0}
                                    </div>
                                    <div class="photo-stat">
                                        <i class="fas fa-comment"></i> ${photo.comments || 0}
                                    </div>
                                    <div class="photo-stat">
                                        <i class="fas fa-download"></i> ${photo.downloads || 0}
                                    </div>
                                </div>
                                ${photo.price > 0 ? 
                                    `<div class="photo-price">$${photo.price.toFixed(2)}</div>
                                     <button class="action-btn buy-btn" onclick="handlePhotoAction('${doc.id}', ${photo.price})">
                                        <i class="fas fa-shopping-cart"></i> Buy Now
                                     </button>` :
                                    `<span class="free-badge">FREE</span>
                                     <button class="action-btn download-btn" onclick="handlePhotoAction('${doc.id}', 0)">
                                        <i class="fas fa-download"></i> Download
                                     </button>`}
                            </div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error("Error loading marketplace photos:", error);
            }
        }

        async function loadUserPhotos(userId) {
            try {
                const q = query(collection(db, "photos"), 
                              where("ownerId", "==", userId),
                              orderBy("createdAt", "desc"));
                const snapshot = await getDocs(q);
                
                const userUploadsContainer = document.getElementById('user-uploads');
                userUploadsContainer.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const photo = doc.data();
                    userUploadsContainer.innerHTML += `
                        <div class="photo-card">
                            <img src="${photo.url}" alt="${photo.title}" class="photo-thumbnail">
                            <div class="photo-details">
                                <h3 class="photo-title">${photo.title}</h3>
                                <div class="photo-stats">
                                    <div class="photo-stat">
                                        <i class="fas fa-heart"></i> ${photo.loves || 0}
                                    </div>
                                    <div class="photo-stat">
                                        <i class="fas fa-comment"></i> ${photo.comments || 0}
                                    </div>
                                    <div class="photo-stat">
                                        <i class="fas fa-download"></i> ${photo.downloads || 0}
                                    </div>
                                </div>
                                <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                                    <button class="action-btn" style="background-color: var(--gray); flex: 1;"
                                            onclick="editPhoto('${doc.id}')">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="action-btn" style="background-color: var(--accent); flex: 1;"
                                            onclick="deletePhoto('${doc.id}')">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                // Update photo count in profile
                document.getElementById('photo-count').textContent = snapshot.size;
            } catch (error) {
                console.error("Error loading user photos:", error);
            }
        }

        async function loadCommunityFeed() {
            try {
                const q = query(collection(db, "photos"), 
                              where("isPublic", "==", true),
                              orderBy("createdAt", "desc"),
                              limit(10));
                const snapshot = await getDocs(q);
                
                const feedContainer = document.getElementById('community-feed');
                feedContainer.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const photo = doc.data();
                    const isLoved = currentUserData?.lovedPhotos?.includes(doc.id) || false;
                    
                    feedContainer.innerHTML += `
                        <div class="feed-post">
                            <div class="post-header">
                                <img src="${photo.ownerPhoto || 'https://source.unsplash.com/random/100x100/?portrait'}" 
                                     alt="User" class="post-user-avatar">
                                <div class="post-user-name">
                                    ${photo.ownerName}
                                    ${photo.ownerSubscription === 'unlimited' ? 
                                        '<span class="pro-badge" style="font-size: 0.6rem; padding: 0.1rem 0.4rem;">PRO</span>' : ''}
                                </div>
                            </div>
                            
                            <img src="${photo.url}" alt="Post" class="post-image">
                            
                            <div class="post-caption">
                                <p>${photo.title}</p>
                                <div class="post-tags">
                                    ${photo.tags?.map(tag => `<span class="post-tag">#${tag}</span>`).join('')}
                                </div>
                            </div>
                            
                            <div class="post-actions">
                                <div class="post-action ${isLoved ? 'liked' : ''}" onclick="toggleLove('${doc.id}')">
                                    <i class="fas fa-heart"></i>
                                    <span>${photo.loves || 0}</span>
                                </div>
                                <div class="post-action">
                                    <i class="fas fa-comment"></i>
                                    <span>${photo.comments || 0}</span>
                                </div>
                                <div class="post-action">
                                    <i class="fas fa-share"></i>
                                    <span>Share</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error("Error loading community feed:", error);
            }
        }

        async function handlePhotoAction(photoId, price) {
            if (!auth.currentUser) {
                showLoginModal();
                return;
            }
            
            if (currentUserData.suspended) {
                showNotification('Account Suspended', 'Your account is suspended. You can only view content.', true);
                return;
            }
            
            if (price > 0) {
                if (confirm(`Purchase this photo for $${price.toFixed(2)}?`)) {
                    await purchasePhoto(photoId, price);
                }
            } else {
                await downloadPhoto(photoId);
            }
        }

        async function purchasePhoto(photoId, price) {
            try {
                // Check download limit
                if (currentUserData.subscription === 'free' && currentUserData.downloadsToday >= 1) {
                    showNotification('Download Limit', 'Free users can download up to 1 photo per day. Upgrade to download more.', true);
                    return;
                }
                
                if (currentUserData.subscription === 'explorer' && currentUserData.downloadsToday >= 5) {
                    showNotification('Download Limit', 'Explorer users can download up to 5 photos per day. Upgrade to unlimited for more.', true);
                    return;
                }
                
                // Record transaction
                await addDoc(collection(db, "transactions"), {
                    userId: auth.currentUser.uid,
                    photoId: photoId,
                    amount: price,
                    type: "photo_purchase",
                    date: serverTimestamp()
                });
                
                // Add to user's purchased photos
                await updateDoc(doc(db, "users", auth.currentUser.uid), {
                    purchasedPhotos: arrayUnion(photoId),
                    downloadsToday: increment(1),
                    totalDownloads: increment(1)
                });
                
                // Update photo owner's earnings
                const photoDoc = await getDoc(doc(db, "photos", photoId));
                if (photoDoc.exists()) {
                    const photo = photoDoc.data();
                    await updateDoc(doc(db, "users", photo.ownerId), {
                        earnings: increment(price * 0.7) // 70% to creator
                    });
                }
                
                showNotification('Success', 'Purchase successful! The photo is now available in your profile.');
            } catch (error) {
                console.error("Purchase error:", error);
                showNotification('Error', 'Purchase failed. Please try again.', true);
            }
        }

        async function downloadPhoto(photoId) {
            try {
                // Check download limit
                if (currentUserData.subscription === 'free' && currentUserData.downloadsToday >= 1) {
                    showNotification('Download Limit', 'Free users can download up to 1 photo per day. Upgrade to download more.', true);
                    return;
                }
                
                if (currentUserData.subscription === 'explorer' && currentUserData.downloadsToday >= 5) {
                    showNotification('Download Limit', 'Explorer users can download up to 5 photos per day. Upgrade to unlimited for more.', true);
                    return;
                }
                
                const photoDoc = await getDoc(doc(db, "photos", photoId));
                if (photoDoc.exists()) {
                    const photo = photoDoc.data();
                    
                    // Record download
                    await updateDoc(doc(db, "photos", photoId), {
                        downloads: increment(1)
                    });
                    
                    // Update user's download count
                    await updateDoc(doc(db, "users", auth.currentUser.uid), {
                        downloadsToday: increment(1),
                        totalDownloads: increment(1)
                    });
                    
                    // Trigger download
                    const a = document.createElement('a');
                    a.href = photo.url;
                    a.download = photo.title || "photo";
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    
                    showNotification('Success', 'Download started!');
                }
            } catch (error) {
                console.error("Download error:", error);
                showNotification('Error', 'Download failed. Please try again.', true);
            }
        }

        async function subscribe(plan) {
            if (!auth.currentUser) {
                showLoginModal();
                return;
            }
            
            try {
                // In a real app, integrate with Stripe/PayPal here
                await updateDoc(doc(db, "users", auth.currentUser.uid), {
                    subscription: plan === 'explorer' ? 'explorer' : 'unlimited'
                });
                
                // Record subscription
                await addDoc(collection(db, "subscriptions"), {
                    userId: auth.currentUser.uid,
                    plan,
                    price: plan === 'explorer' ? 2.99 : 7.99,
                    startDate: serverTimestamp(),
                    endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days from now
                    status: 'active'
                });
                
                showNotification('Success', `Subscription updated to ${plan} plan!`);
                closeModal();
                updateUserProfile(auth.currentUser);
            } catch (error) {
                console.error("Subscription error:", error);
                showNotification('Error', 'Subscription failed. Please try again.', true);
            }
        }

        // ========================================
        // UI FUNCTIONS
        // ========================================

        function showSection(sectionId) {
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Activate clicked nav item
            const navItems = document.querySelectorAll('.nav-item');
            const sectionIndex = ['home', 'marketplace', 'feed', 'profile', 'about'].indexOf(sectionId);
            if (sectionIndex >= 0) {
                navItems[sectionIndex].classList.add('active');
            }
            
            // Show section
            document.querySelectorAll('section[id$="-section"]').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(`${sectionId}-section`).style.display = 'block';
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function switchTab(tabId) {
            document.querySelectorAll('.profile-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('#uploads-tab, #favorites-tab, #purchased-tab, #monetization-tab').forEach(tab => {
                tab.style.display = 'none';
            });
            
            document.getElementById(`${tabId}-tab`).style.display = 'block';
        }

        function showLoginModal() {
            document.getElementById('login-modal').classList.add('active');
        }

        function showSubscriptionModal() {
            if (!auth.currentUser) {
                showLoginModal();
                return;
            }
            document.getElementById('subscription-modal').classList.add('active');
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
            
            // Reset upload form
            document.getElementById('upload-preview').style.display = 'none';
            document.getElementById('photo-title').value = '';
            document.getElementById('photo-price').value = '';
            tags = [];
            renderTags();
            selectedFile = null;
        }

        function selectPlan(planId) {
            document.querySelectorAll('.subscription-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.getElementById(`${planId}-plan`).classList.add('selected');
        }

        function filterPhotos(type) {
            loadMarketplacePhotos(type);
        }

        // ========================================
        // INITIALIZATION
        // ========================================

        document.addEventListener('DOMContentLoaded', () => {
            // Simulate loading screen
            setTimeout(() => {
                document.querySelector('.loading-screen').classList.add('hidden');
            }, 1500);

            // Set up auth state listener
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    currentUser = user;
                    console.log("User signed in:", user.uid);
                    updateUserProfile(user);
                    
                    // Check if user is admin
                    getDoc(doc(db, "users", user.uid)).then(doc => {
                        if (doc.exists() && doc.data().isAdmin) {
                            document.getElementById('admin-section').style.display = 'block';
                        }
                    });
                } else {
                    currentUser = null;
                    currentUserData = null;
                    console.log("User signed out");
                }
            });

            // Load initial data
            loadFeaturedPhotos();
            loadMarketplacePhotos();
            loadCommunityFeed();

            // Set up event listeners
            googleLoginBtn.addEventListener('click', signInWithGoogle);
        });

        // Make functions available globally for HTML onclick attributes
        window.showSection = showSection;
        window.switchTab = switchTab;
        window.showLoginModal = showLoginModal;
        window.showSubscriptionModal = showSubscriptionModal;
        window.closeModal = closeModal;
        window.selectPlan = selectPlan;
        window.subscribe = subscribe;
        window.handlePhotoAction = handlePhotoAction;
        window.filterPhotos = filterPhotos;
        window.toggleLove = toggleLove;
        window.addTag = addTag;
        window.removeTag = removeTag;
        window.uploadPhoto = uploadPhoto;
        window.applyForMonetization = applyForMonetization;
        window.updatePhotoPrice = updatePhotoPrice;
        window.notifyAllUsers = notifyAllUsers;
        window.manageUsers = manageUsers;
        window.moderateContent = moderateContent;
        window.sendNotification = sendNotification;
        window.sendUserNotification = sendUserNotification;
        window.suspendUser = suspendUser;
        window.approveMonetization = approveMonetization;
        window.rejectMonetization = rejectMonetization;
        window.removeContent = removeContent;
        window.dismissReport = dismissReport;
        window.viewUser = viewUser;
        window.hideNotification = hideNotification;
    </script>
</body>
</html>
